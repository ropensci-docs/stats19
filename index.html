<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Tools to help download, process and analyse the UK road collision data collected using the
  STATS19 form. The datasets are provided as CSV files with detailed road safety information about the
  circumstances of car crashes and other incidents on the roads resulting in casualties in Great Britain
  from 1979 to present. Tables are available on colissions with the circumstances (e.g. speed limit
  of road), information about  vehicles involved (e.g. type of vehicle), and casualties (e.g. age).
  The statistics relate only to events on public roads that were reported
  to the police, and subsequently recorded, using the STATS19 collision reporting form. See
  the Department for Transport website 
  &lt;https://www.data.gov.uk/dataset/cb7ae6f0-4be6-4935-9277-47e5ce24a11f/road-safety-data&gt; for more
  information on these datasets.
  The package is described in a paper in the Journal of Open Source Software
  (Lovelace et al. 2019) &lt;doi:10.21105/joss.01181&gt;.
  See 
  Gilardi et al. (2022) &lt;doi:10.1111/rssa.12823&gt;,
  Vidal-Tortosa et al. (2021) &lt;doi:10.1016/j.jth.2021.101291&gt;, and
  Tait et al. (2023) &lt;doi:10.1016/j.aap.2022.106895&gt; for examples of how the data can be used for
  methodological and empirical road safety research.">
<title>Work with Open Road Traffic Casualty Data from Great Britain • stats19</title>
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Work with Open Road Traffic Casualty Data from Great Britain">
<meta property="og:description" content="Tools to help download, process and analyse the UK road collision data collected using the
  STATS19 form. The datasets are provided as CSV files with detailed road safety information about the
  circumstances of car crashes and other incidents on the roads resulting in casualties in Great Britain
  from 1979 to present. Tables are available on colissions with the circumstances (e.g. speed limit
  of road), information about  vehicles involved (e.g. type of vehicle), and casualties (e.g. age).
  The statistics relate only to events on public roads that were reported
  to the police, and subsequently recorded, using the STATS19 collision reporting form. See
  the Department for Transport website 
  &lt;https://www.data.gov.uk/dataset/cb7ae6f0-4be6-4935-9277-47e5ce24a11f/road-safety-data&gt; for more
  information on these datasets.
  The package is described in a paper in the Journal of Open Source Software
  (Lovelace et al. 2019) &lt;doi:10.21105/joss.01181&gt;.
  See 
  Gilardi et al. (2022) &lt;doi:10.1111/rssa.12823&gt;,
  Vidal-Tortosa et al. (2021) &lt;doi:10.1016/j.jth.2021.101291&gt;, and
  Tait et al. (2023) &lt;doi:10.1016/j.aap.2022.106895&gt; for examples of how the data can be used for
  methodological and empirical road safety research.">
<meta property="og:image" content="https://docs.ropensci.org/stats19/logo.svg">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="index.html">stats19</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">3.0.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="articles/stats19.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/blog.html">stats19: a package for road safety research</a>
    <a class="dropdown-item" href="articles/stats19-training-setup.html">An introduction to road safety analysis with R: setup notes</a>
    <a class="dropdown-item" href="articles/stats19-training.html">Introduction to R for road safety: an introduction to R and practical exercises</a>
    <a class="dropdown-item" href="articles/stats19-vehicles.html">Researching vehicles involved in collisions with STATS19 data</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/stats19/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9">
<!-- [![DOI](https://zenodo.org/badge/DOI/10.5281/zenodo.2540781.svg)](https://doi.org/10.5281/zenodo.2540781) --><!-- [![Gitter chat](https://badges.gitter.im/ITSLeeds/stats19.png)](https://gitter.im/stats19/Lobby?source=orgpage) --><!-- README.md is generated from README.Rmd. Please edit that file --><div class="section level1">
<div class="page-header">
<img src="logo.svg" class="logo" alt=""><h1 id="stats19-">stats19 
<a class="anchor" aria-label="anchor" href="#stats19-"></a>
</h1>
</div>
<p><strong>stats19</strong> provides functions for downloading and formatting road crash data. Specifically, it enables access to the UK’s official road traffic casualty database, <a href="https://www.data.gov.uk/dataset/cb7ae6f0-4be6-4935-9277-47e5ce24a11f/road-safety-data" class="external-link">STATS19</a>. (The name comes from the form used by the police to record car crashes and other incidents resulting in casualties on the roads.)</p>
<p>A full overview of STATS19 variables be found in a <a href="https://data.dft.gov.uk/road-accidents-safety-data/Brief-guide-to%20road-accidents-and-safety-data.doc" class="external-link">document</a> provided by the UK’s Department for Transport (DfT).</p>
<p>The raw data is provided as a series of <code>.csv</code> files that contain integers and which are stored in dozens of <code>.zip</code> files. Finding, reading-in and formatting the data for research can be a time consuming process subject to human error. <strong>stats19</strong> speeds up these vital but boring and error-prone stages of the research process with a single function: <code><a href="reference/get_stats19.html">get_stats19()</a></code>. By allowing public access to properly labelled road crash data, <strong>stats19</strong> aims to make road safety research more reproducible and accessible.</p>
<p>For transparency and modularity, each stage can be undertaken separately, as documented in the <a href="https://itsleeds.github.io/stats19/articles/stats19.html" class="external-link">stats19 vignette</a>.</p>
<p>The package has now been peer reviewed and is stable, and has been published in the Journal of Open Source Software (Lovelace et al. 2019). Please tell people about the package, link to it and cite it if you use it in your work.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Install and load the latest version with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"ropensci/stats19"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/stats19">stats19</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Data provided under OGL v3.0. Cite the source and link to:</span></span>
<span><span class="co">#&gt; www.nationalarchives.gov.uk/doc/open-government-licence/version/3/</span></span></code></pre></div>
<p>You can install the released version of stats19 from <a href="https://cran.r-project.org/package=stats19" class="external-link">CRAN</a> with:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"stats19"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="get_stats19">get_stats19()<a class="anchor" aria-label="anchor" href="#get_stats19"></a>
</h2>
<p><code><a href="reference/get_stats19.html">get_stats19()</a></code> requires <code>year</code> and <code>type</code> parameters, mirroring the provision of STATS19 data files, which are categorised by year (from 1979 onward) and type (with separate tables for crashes, casualties and vehicles, as outlined below). The following command, for example, gets crash data from 2022 (<strong>note</strong>: we follow the “crash not accident” campaign of <a href="https://www.roadpeace.org/get-involved/crash-not-accident/" class="external-link">RoadPeace</a> in naming crashes, although the DfT refers to the relevant tables as ‘accidents’ data):</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">crashes</span> <span class="op">=</span> <span class="fu"><a href="reference/get_stats19.html">get_stats19</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2022</span>, type <span class="op">=</span> <span class="st">"collision"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Files identified: dft-road-casualty-statistics-collision-2022.csv</span></span>
<span><span class="co">#&gt;    https://data.dft.gov.uk/road-accidents-safety-data/dft-road-casualty-statistics-collision-2022.csv</span></span>
<span><span class="co">#&gt; Data already exists in data_dir, not downloading</span></span>
<span><span class="co">#&gt; Reading in:</span></span>
<span><span class="co">#&gt; ~/data/stats19/dft-road-casualty-statistics-collision-2022.csv</span></span>
<span><span class="co">#&gt; Rows: 106004 Columns: 36</span></span>
<span><span class="co">#&gt; ── Column specification ────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; Delimiter: ","</span></span>
<span><span class="co">#&gt; chr   (6): accident_index, accident_reference, date, local_authority_ons_dis...</span></span>
<span><span class="co">#&gt; dbl  (29): accident_year, location_easting_osgr, location_northing_osgr, lon...</span></span>
<span><span class="co">#&gt; time  (1): time</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ℹ Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">#&gt; ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span><span class="co">#&gt; date and time columns present, creating formatted datetime column</span></span></code></pre></div>
<p>What just happened? For the <code>year</code> 2022 we read-in crash-level (<code>type = "collision"</code>) data on all road crashes recorded by the police across Great Britain. The dataset contains 37 columns (variables) for 106,004 crashes. We were not asked to download the file (by default you are asked to confirm the file that will be downloaded). The contents of this dataset, and other datasets provided by <strong>stats19</strong>, are outlined below and described in more detail in the <a href="https://itsleeds.github.io/stats19/articles/stats19.html" class="external-link">stats19 vignette</a>.</p>
<p>We will see below how the function also works to get the corresponding casualty and vehicle datasets for 2022. The package also allows STATS19 files to be downloaded and read-in separately, allowing more control over what you download, and subsequently read-in, with <code><a href="reference/read_collisions.html">read_collisions()</a></code>, <code><a href="reference/read_casualties.html">read_casualties()</a></code> and <code><a href="reference/read_vehicles.html">read_vehicles()</a></code>, as described in the vignette.</p>
</div>
<div class="section level2">
<h2 id="data-download">Data download<a class="anchor" aria-label="anchor" href="#data-download"></a>
</h2>
<p>Data files can be downloaded without reading them in using the function <code><a href="reference/dl_stats19.html">dl_stats19()</a></code>. If there are multiple matches, you will be asked to choose from a range of options. Providing just the year, for example, will result in the following options:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/dl_stats19.html">dl_stats19</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2022</span>, data_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>Multiple matches. Which do you want to download?</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">:</span> dft<span class="sc">-</span>road<span class="sc">-</span>casualty<span class="sc">-</span>statistics<span class="sc">-</span>casualty<span class="fl">-2022.</span>csv</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">:</span> dft<span class="sc">-</span>road<span class="sc">-</span>casualty<span class="sc">-</span>statistics<span class="sc">-</span>vehicle<span class="fl">-2022.</span>csv</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span><span class="sc">:</span> dft<span class="sc">-</span>road<span class="sc">-</span>casualty<span class="sc">-</span>statistics<span class="sc">-</span>collision<span class="fl">-2022.</span>csv</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>Selection<span class="sc">:</span> </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>Enter an item from the menu, or <span class="dv">0</span> to exit</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="using-the-data">Using the data<a class="anchor" aria-label="anchor" href="#using-the-data"></a>
</h2>
<p>STATS19 data consists of 3 main tables:</p>
<ul>
<li>Accidents, the main table which contains information on the crash time, location and other variables (37 columns in total)</li>
<li>Casualties, containing data on people hurt or killed in each crash (19 columns in total)</li>
<li>Vehicles, containing data on vehicles involved in or causing each crash (28 columns in total)</li>
</ul>
<p>The contents of each is outlined below.</p>
<div class="section level3">
<h3 id="crash-data">Crash data<a class="anchor" aria-label="anchor" href="#crash-data"></a>
</h3>
<p>Crash data was downloaded and read-in using the function <code><a href="reference/get_stats19.html">get_stats19()</a></code>, as described above.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">crashes</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 106004</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">crashes</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 37</span></span></code></pre></div>
<p>Some of the key variables in this dataset include:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">key_column_names</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"severity|speed|pedestrian|light_conditions"</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">crashes</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">crashes</span><span class="op">[</span><span class="va">key_column_names</span><span class="op">]</span></span>
<span><span class="co">#&gt; # A tibble: 106,004 × 5</span></span>
<span><span class="co">#&gt;    accident_severity speed_limit pedestrian_crossing_hu…¹ pedestrian_crossing_…²</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;                   &lt;dbl&gt; &lt;chr&gt;                    &lt;chr&gt;                 </span></span>
<span><span class="co">#&gt;  1 Slight                     30 None within 50 metres    No physical crossing …</span></span>
<span><span class="co">#&gt;  2 Slight                     50 None within 50 metres    Pelican, puffin, touc…</span></span>
<span><span class="co">#&gt;  3 Slight                     30 None within 50 metres    No physical crossing …</span></span>
<span><span class="co">#&gt;  4 Slight                     30 None within 50 metres    No physical crossing …</span></span>
<span><span class="co">#&gt;  5 Slight                     50 None within 50 metres    No physical crossing …</span></span>
<span><span class="co">#&gt;  6 Serious                    30 None within 50 metres    No physical crossing …</span></span>
<span><span class="co">#&gt;  7 Slight                     30 None within 50 metres    No physical crossing …</span></span>
<span><span class="co">#&gt;  8 Slight                     40 None within 50 metres    No physical crossing …</span></span>
<span><span class="co">#&gt;  9 Slight                     30 None within 50 metres    Pedestrian phase at t…</span></span>
<span><span class="co">#&gt; 10 Serious                    20 None within 50 metres    Zebra                 </span></span>
<span><span class="co">#&gt; # ℹ 105,994 more rows</span></span>
<span><span class="co">#&gt; # ℹ abbreviated names: ¹​pedestrian_crossing_human_control,</span></span>
<span><span class="co">#&gt; #   ²​pedestrian_crossing_physical_facilities</span></span>
<span><span class="co">#&gt; # ℹ 1 more variable: light_conditions &lt;chr&gt;</span></span></code></pre></div>
<p>For the full list of columns, run <code>names(crashes)</code> or see the <a href="https://github.com/ropensci/stats19/blob/master/vignettes/stats19.Rmd" class="external-link">vignette</a>.</p>
<!-- This means `crashes` is much more usable than `crashes_raw`, as shown below, which shows three records and some key variables in the messy and clean datasets: -->
</div>
<div class="section level3">
<h3 id="casualties-data">Casualties data<a class="anchor" aria-label="anchor" href="#casualties-data"></a>
</h3>
<p>As with <code>crashes</code>, casualty data for 2022 can be downloaded, read-in and formatted as follows:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">casualties</span> <span class="op">=</span> <span class="fu"><a href="reference/get_stats19.html">get_stats19</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2022</span>, type <span class="op">=</span> <span class="st">"casualty"</span>, ask <span class="op">=</span> <span class="cn">FALSE</span>, format <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Files identified: dft-road-casualty-statistics-casualty-2022.csv</span></span>
<span><span class="co">#&gt;    https://data.dft.gov.uk/road-accidents-safety-data/dft-road-casualty-statistics-casualty-2022.csv</span></span>
<span><span class="co">#&gt; Data already exists in data_dir, not downloading</span></span>
<span><span class="co">#&gt; Rows: 135480 Columns: 19</span></span>
<span><span class="co">#&gt; ── Column specification ────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; Delimiter: ","</span></span>
<span><span class="co">#&gt; chr  (3): accident_index, accident_reference, lsoa_of_casualty</span></span>
<span><span class="co">#&gt; dbl (16): accident_year, vehicle_reference, casualty_reference, casualty_cla...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ℹ Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">#&gt; ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">casualties</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 135480</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">casualties</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 19</span></span></code></pre></div>
<p>The results show that there were 135,480 casualties reported by the police in the STATS19 dataset in 2022, and 19 columns (variables). Values for a sample of these columns are shown below:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">casualties</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">14</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; # A tibble: 135,480 × 4</span></span>
<span><span class="co">#&gt;    vehicle_reference casualty_reference casualty_class  bus_or_coach_passenger  </span></span>
<span><span class="co">#&gt;                &lt;dbl&gt;              &lt;dbl&gt; &lt;chr&gt;           &lt;chr&gt;                   </span></span>
<span><span class="co">#&gt;  1                 2                  1 Driver or rider Not a bus or coach pass…</span></span>
<span><span class="co">#&gt;  2                 1                  1 Driver or rider Not a bus or coach pass…</span></span>
<span><span class="co">#&gt;  3                 1                  1 Driver or rider Not a bus or coach pass…</span></span>
<span><span class="co">#&gt;  4                 1                  1 Driver or rider Not a bus or coach pass…</span></span>
<span><span class="co">#&gt;  5                 1                  2 Passenger       Not a bus or coach pass…</span></span>
<span><span class="co">#&gt;  6                 1                  1 Driver or rider Not a bus or coach pass…</span></span>
<span><span class="co">#&gt;  7                 2                  2 Driver or rider Not a bus or coach pass…</span></span>
<span><span class="co">#&gt;  8                 3                  3 Driver or rider Not a bus or coach pass…</span></span>
<span><span class="co">#&gt;  9                 1                  1 Driver or rider Not a bus or coach pass…</span></span>
<span><span class="co">#&gt; 10                 1                  2 Passenger       Not a bus or coach pass…</span></span>
<span><span class="co">#&gt; # ℹ 135,470 more rows</span></span></code></pre></div>
<p>The full list of column names in the <code>casualties</code> dataset is:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">casualties</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "accident_index"                     "accident_year"                     </span></span>
<span><span class="co">#&gt;  [3] "accident_reference"                 "vehicle_reference"                 </span></span>
<span><span class="co">#&gt;  [5] "casualty_reference"                 "casualty_class"                    </span></span>
<span><span class="co">#&gt;  [7] "sex_of_casualty"                    "age_of_casualty"                   </span></span>
<span><span class="co">#&gt;  [9] "age_band_of_casualty"               "casualty_severity"                 </span></span>
<span><span class="co">#&gt; [11] "pedestrian_location"                "pedestrian_movement"               </span></span>
<span><span class="co">#&gt; [13] "car_passenger"                      "bus_or_coach_passenger"            </span></span>
<span><span class="co">#&gt; [15] "pedestrian_road_maintenance_worker" "casualty_type"                     </span></span>
<span><span class="co">#&gt; [17] "casualty_home_area_type"            "casualty_imd_decile"               </span></span>
<span><span class="co">#&gt; [19] "lsoa_of_casualty"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="vehicles-data">Vehicles data<a class="anchor" aria-label="anchor" href="#vehicles-data"></a>
</h3>
<p>Data for vehicles involved in crashes in 2022 can be downloaded, read-in and formatted as follows:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vehicles</span> <span class="op">=</span> <span class="fu"><a href="reference/get_stats19.html">get_stats19</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2022</span>, type <span class="op">=</span> <span class="st">"vehicle"</span>, ask <span class="op">=</span> <span class="cn">FALSE</span>, format <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Files identified: dft-road-casualty-statistics-vehicle-2022.csv</span></span>
<span><span class="co">#&gt;    https://data.dft.gov.uk/road-accidents-safety-data/dft-road-casualty-statistics-vehicle-2022.csv</span></span>
<span><span class="co">#&gt; Data already exists in data_dir, not downloading</span></span>
<span><span class="co">#&gt; Rows: 193545 Columns: 28</span></span>
<span><span class="co">#&gt; ── Column specification ────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; Delimiter: ","</span></span>
<span><span class="co">#&gt; chr  (4): accident_index, accident_reference, generic_make_model, lsoa_of_dr...</span></span>
<span><span class="co">#&gt; dbl (24): accident_year, vehicle_reference, vehicle_type, towing_and_articul...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ℹ Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">#&gt; ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">vehicles</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 193545</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">vehicles</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 28</span></span></code></pre></div>
<p>The results show that there were 193,545 vehicles involved in crashes reported by the police in the STATS19 dataset in 2022, with 28 columns (variables). Values for a sample of these columns are shown below:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vehicles</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">14</span><span class="op">:</span><span class="fl">16</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; # A tibble: 193,545 × 4</span></span>
<span><span class="co">#&gt;    accident_reference vehicle_leaving_carriageway hit_object_off_carriageway </span></span>
<span><span class="co">#&gt;    &lt;chr&gt;              &lt;chr&gt;                       &lt;chr&gt;                      </span></span>
<span><span class="co">#&gt;  1 010352073          Did not leave carriageway   None                       </span></span>
<span><span class="co">#&gt;  2 010352073          Did not leave carriageway   None                       </span></span>
<span><span class="co">#&gt;  3 010352573          Nearside                    Road sign or traffic signal</span></span>
<span><span class="co">#&gt;  4 010352573          Did not leave carriageway   None                       </span></span>
<span><span class="co">#&gt;  5 010352575          Did not leave carriageway   None                       </span></span>
<span><span class="co">#&gt;  6 010352575          Did not leave carriageway   None                       </span></span>
<span><span class="co">#&gt;  7 010352578          Did not leave carriageway   None                       </span></span>
<span><span class="co">#&gt;  8 010352578          Did not leave carriageway   None                       </span></span>
<span><span class="co">#&gt;  9 010352580          Did not leave carriageway   None                       </span></span>
<span><span class="co">#&gt; 10 010352580          Did not leave carriageway   None                       </span></span>
<span><span class="co">#&gt; # ℹ 193,535 more rows</span></span>
<span><span class="co">#&gt; # ℹ 1 more variable: first_point_of_impact &lt;chr&gt;</span></span></code></pre></div>
<p>The full list of column names in the <code>vehicles</code> dataset is:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">vehicles</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "accident_index"                   "accident_year"                   </span></span>
<span><span class="co">#&gt;  [3] "accident_reference"               "vehicle_reference"               </span></span>
<span><span class="co">#&gt;  [5] "vehicle_type"                     "towing_and_articulation"         </span></span>
<span><span class="co">#&gt;  [7] "vehicle_manoeuvre"                "vehicle_direction_from"          </span></span>
<span><span class="co">#&gt;  [9] "vehicle_direction_to"             "vehicle_location_restricted_lane"</span></span>
<span><span class="co">#&gt; [11] "junction_location"                "skidding_and_overturning"        </span></span>
<span><span class="co">#&gt; [13] "hit_object_in_carriageway"        "vehicle_leaving_carriageway"     </span></span>
<span><span class="co">#&gt; [15] "hit_object_off_carriageway"       "first_point_of_impact"           </span></span>
<span><span class="co">#&gt; [17] "vehicle_left_hand_drive"          "journey_purpose_of_driver"       </span></span>
<span><span class="co">#&gt; [19] "sex_of_driver"                    "age_of_driver"                   </span></span>
<span><span class="co">#&gt; [21] "age_band_of_driver"               "engine_capacity_cc"              </span></span>
<span><span class="co">#&gt; [23] "propulsion_code"                  "age_of_vehicle"                  </span></span>
<span><span class="co">#&gt; [25] "generic_make_model"               "driver_imd_decile"               </span></span>
<span><span class="co">#&gt; [27] "driver_home_area_type"            "lsoa_of_driver"</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="creating-geographic-crash-data">Creating geographic crash data<a class="anchor" aria-label="anchor" href="#creating-geographic-crash-data"></a>
</h2>
<p>An important feature of STATS19 data is that the collision table contains geographic coordinates. These are provided at ~10m resolution in the UK’s official coordinate reference system (the Ordnance Survey National Grid, EPSG code 27700). <strong>stats19</strong> converts the non-geographic tables created by <code><a href="reference/format_collisions.html">format_collisions()</a></code> into the geographic data form of the <a href="https://cran.r-project.org/package=sf" class="external-link"><code>sf</code> package</a> with the function <code><a href="reference/format_sf.html">format_sf()</a></code> as follows:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">crashes_sf</span> <span class="op">=</span> <span class="fu"><a href="reference/format_sf.html">format_sf</a></span><span class="op">(</span><span class="va">crashes</span><span class="op">)</span></span>
<span><span class="co">#&gt; 22 rows removed with no coordinates</span></span></code></pre></div>
<p>The note arises because <code>NA</code> values are not permitted in <code>sf</code> coordinates, and so rows containing no coordinates are automatically removed. Having the data in a standard geographic form allows various geographic operations to be performed on it. The following code chunk, for example, returns all crashes within the boundary of West Yorkshire (which is contained in the object <a href="https://itsleeds.github.io/stats19/reference/police_boundaries.html" class="external-link"><code>police_boundaries</code></a>, an <code>sf</code> data frame containing all police jurisdictions in England and Wales).</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Linking to GEOS 3.11.1, GDAL 3.6.4, PROJ 9.1.1; sf_use_s2() is TRUE</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="va">wy</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">police_boundaries</span>, <span class="va">pfa16nm</span> <span class="op">==</span> <span class="st">"West Yorkshire"</span><span class="op">)</span></span>
<span><span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span></span>
<span><span class="va">crashes_wy</span> <span class="op">=</span> <span class="va">crashes_sf</span><span class="op">[</span><span class="va">wy</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">crashes_sf</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 105982</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">crashes_wy</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4400</span></span></code></pre></div>
<p>This subsetting has selected the 4,400 crashes which occurred within West Yorkshire in 2022.</p>
</div>
<div class="section level2">
<h2 id="joining-tables">Joining tables<a class="anchor" aria-label="anchor" href="#joining-tables"></a>
</h2>
<p>The three main tables we have just read-in can be joined by shared key variables. This is demonstrated in the code chunk below, which subsets all casualties that took place in Leeds, and counts the number of casualties by severity for each crash:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sel</span> <span class="op">=</span> <span class="va">casualties</span><span class="op">$</span><span class="va">accident_index</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">crashes_wy</span><span class="op">$</span><span class="va">accident_index</span></span>
<span><span class="va">casualties_wy</span> <span class="op">=</span> <span class="va">casualties</span><span class="op">[</span><span class="va">sel</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">casualties_wy</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "accident_index"                     "accident_year"                     </span></span>
<span><span class="co">#&gt;  [3] "accident_reference"                 "vehicle_reference"                 </span></span>
<span><span class="co">#&gt;  [5] "casualty_reference"                 "casualty_class"                    </span></span>
<span><span class="co">#&gt;  [7] "sex_of_casualty"                    "age_of_casualty"                   </span></span>
<span><span class="co">#&gt;  [9] "age_band_of_casualty"               "casualty_severity"                 </span></span>
<span><span class="co">#&gt; [11] "pedestrian_location"                "pedestrian_movement"               </span></span>
<span><span class="co">#&gt; [13] "car_passenger"                      "bus_or_coach_passenger"            </span></span>
<span><span class="co">#&gt; [15] "pedestrian_road_maintenance_worker" "casualty_type"                     </span></span>
<span><span class="co">#&gt; [17] "casualty_home_area_type"            "casualty_imd_decile"               </span></span>
<span><span class="co">#&gt; [19] "lsoa_of_casualty"</span></span>
<span><span class="va">cas_types</span> <span class="op">=</span> <span class="va">casualties_wy</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">accident_index</span>, <span class="va">casualty_type</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">accident_index</span>, <span class="va">casualty_type</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/spread.html" class="external-link">spread</a></span><span class="op">(</span><span class="va">casualty_type</span>, <span class="va">n</span>, fill <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">cas_types</span><span class="op">$</span><span class="va">Total</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">cas_types</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">cj</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">crashes_wy</span>, <span class="va">cas_types</span>, by <span class="op">=</span> <span class="st">"accident_index"</span><span class="op">)</span></span></code></pre></div>
<p>What just happened? We found the subset of casualties that took place in West Yorkshire with reference to the <code>accident_index</code> variable. Then we used functions from the <strong>tidyverse</strong> package <strong>dplyr</strong> (and <code>spread()</code> from <strong>tidyr</strong>) to create a dataset with a column for each casualty type. We then joined the updated casualty data onto the <code>crashes_wy</code> dataset. The result is a spatial (<code>sf</code>) data frame of crashes in Leeds, with columns counting how many road users of different types were hurt. The original and joined data look like this:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">crashes_wy</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">accident_index</span>, <span class="va">accident_severity</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_drop_geometry</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 4,400 × 2</span></span>
<span><span class="co">#&gt;    accident_index accident_severity</span></span>
<span><span class="co">#&gt;  * &lt;chr&gt;          &lt;chr&gt;            </span></span>
<span><span class="co">#&gt;  1 2022121205585  Slight           </span></span>
<span><span class="co">#&gt;  2 2022131127664  Slight           </span></span>
<span><span class="co">#&gt;  3 2022131127681  Serious          </span></span>
<span><span class="co">#&gt;  4 2022131127764  Serious          </span></span>
<span><span class="co">#&gt;  5 2022131127766  Slight           </span></span>
<span><span class="co">#&gt;  6 2022131127829  Slight           </span></span>
<span><span class="co">#&gt;  7 2022131127841  Serious          </span></span>
<span><span class="co">#&gt;  8 2022131127847  Slight           </span></span>
<span><span class="co">#&gt;  9 2022131127861  Slight           </span></span>
<span><span class="co">#&gt; 10 2022131127881  Slight           </span></span>
<span><span class="co">#&gt; # ℹ 4,390 more rows</span></span>
<span><span class="va">cas_types</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"accident_index"</span>, <span class="st">"Cyclist"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 2</span></span>
<span><span class="co">#&gt; # Groups:   accident_index [2]</span></span>
<span><span class="co">#&gt;   accident_index Cyclist</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;            &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 2022121205585        0</span></span>
<span><span class="co">#&gt; 2 2022131127664        0</span></span>
<span><span class="va">cj</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">34</span><span class="op">)</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_drop_geometry</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 3</span></span>
<span><span class="co">#&gt;   accident_index latitude lsoa_of_accident_location</span></span>
<span><span class="co">#&gt; * &lt;chr&gt;             &lt;dbl&gt; &lt;chr&gt;                    </span></span>
<span><span class="co">#&gt; 1 2022121205585      53.8 E01027904                </span></span>
<span><span class="co">#&gt; 2 2022131127664      53.7 E01011132</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="mapping-crashes">Mapping crashes<a class="anchor" aria-label="anchor" href="#mapping-crashes"></a>
</h2>
<p>The join operation added a geometry column to the casualty data, enabling it to be mapped (for more advanced maps, see the <a href="https://itsleeds.github.io/stats19/articles/stats19.html" class="external-link">vignette</a>):</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cex</span> <span class="op">=</span> <span class="va">cj</span><span class="op">$</span><span class="va">Total</span> <span class="op">/</span> <span class="fl">3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cj</span><span class="op">[</span><span class="st">"speed_limit"</span><span class="op">]</span>, cex <span class="op">=</span> <span class="va">cex</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-3-1.png" width="100%"></p>
<p>The spatial distribution of crashes in West Yorkshire clearly relates to the region’s geography. Crashes tend to happen on busy Motorway roads (with a high speed limit, of 70 miles per hour, as shown in the map above) and city centres, of Leeds and Bradford in particular. The severity and number of people hurt (proportional to circle width in the map above) in crashes is related to the speed limit.</p>
<p>STATS19 data can be used as the basis of road safety research. The map below, for example, shows the results of an academic paper on the social, spatial and temporal distribution of bike crashes in West Yorkshire, which estimated the number of crashes per billion km cycled based on commuter cycling as a proxy for cycling levels overall (more sophisticated measures of cycling levels are now possible thanks to new data sources) (Lovelace, Roberts, and Kellar 2016):</p>
<p><img src="https://ars.els-cdn.com/content/image/1-s2.0-S136984781500039X-gr9.jpg" width="100%"></p>
</div>
<div class="section level2">
<h2 id="time-series-analysis">Time series analysis<a class="anchor" aria-label="anchor" href="#time-series-analysis"></a>
</h2>
<p>We can also explore seasonal trends in crashes by aggregating crashes by day of the year:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cj</span><span class="op">$</span><span class="va">date</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "2022-08-03" "2022-01-01" "2022-01-01" "2022-01-01" "2022-01-01"</span></span>
<span><span class="co">#&gt; [6] "2022-01-01"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">cj</span><span class="op">$</span><span class="va">date</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Date"</span></span>
<span><span class="va">crashes_dates</span> <span class="op">=</span> <span class="va">cj</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_set_geometry</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    walking <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Pedestrian</span><span class="op">)</span>,</span>
<span>    cycling <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Cyclist</span><span class="op">)</span>,</span>
<span>    passenger <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">`Car occupant`</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span><span class="va">mode</span>, <span class="va">casualties</span>, <span class="op">-</span><span class="va">date</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">crashes_dates</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">casualties</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">mode</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"loess"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Casualties per day"</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre></div>
<p><img src="reference/figures/README-crash-date-plot-1.png" width="100%"></p>
<p>Different types of crashes also tend to happen at different times of day. This is illustrated in the plot below, which shows the times of day when people who were travelling by different modes were most commonly injured.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">crash_times</span> <span class="op">=</span> <span class="va">cj</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_set_geometry</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span>hour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html" class="external-link">str_sub</a></span><span class="op">(</span><span class="va">time</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    walking <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Pedestrian</span><span class="op">)</span>,</span>
<span>    cycling <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Cyclist</span><span class="op">)</span>,</span>
<span>    passenger <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">`Car occupant`</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span><span class="va">mode</span>, <span class="va">casualties</span>, <span class="op">-</span><span class="va">hour</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">crash_times</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">hour</span>, <span class="va">casualties</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">mode</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-crash-time-plot-1.png" width="100%"></p>
<p>Note that cycling manifests distinct morning and afternoon peaks (see Lovelace, Roberts, and Kellar 2016 for more on this).</p>
</div>
<div class="section level2">
<h2 id="usage-in-research-and-policy-contexts">Usage in research and policy contexts<a class="anchor" aria-label="anchor" href="#usage-in-research-and-policy-contexts"></a>
</h2>
<p>Examples of how the package can been used for policy making include:</p>
<ul><li>Use of the package in a web app created by the library service of the UK Parliament. See <a href="https://commonslibrary.parliament.uk/constituency-data-traffic-accidents/" class="external-link">commonslibrary.parliament.uk</a>, screenshots of which from December 2019 are shown below, for details.</li></ul>
<p><img src="https://user-images.githubusercontent.com/1825120/70164249-bf730080-16b8-11ea-96d8-ec92c0b5cc69.png"></p>
<ul>
<li><p>Use of methods taught in the <a href="https://docs.ropensci.org/stats19/articles/stats19-training.html">stats19-training</a> vignette by road safety analysts at Essex Highways and the Safer Essex Roads Partnership (<a href="https://saferessexroads.org/" class="external-link">SERP</a>) to inform the deployment of proactive front-line police enforcement in the region (credit: Will Cubbin).</p></li>
<li><p>Mention of road crash data analysis based on the package in an <a href="https://www.theguardian.com/cities/2019/oct/07/a-deadly-problem-should-we-ban-suvs-from-our-cities" class="external-link">article</a> on urban SUVs. The question of how vehicle size and type relates to road safety is an important area of future research. A starting point for researching this topic can be found in the <a href="https://docs.ropensci.org/stats19/articles/stats19-vehicles.html"><code>stats19-vehicles</code></a> vignette, representing a possible next step in terms of how the data can be used.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="next-steps">Next steps<a class="anchor" aria-label="anchor" href="#next-steps"></a>
</h2>
<p>There is much important research that needs to be done to help make the transport systems in many cities safer. Even if you’re not working with UK data, we hope that the data provided by <strong>stats19</strong> data can help safety researchers develop new methods to better understand the reasons why people are needlessly hurt and killed on the roads.</p>
<p>The next step is to gain a deeper understanding of <strong>stats19</strong> and the data it provides. Then it’s time to pose interesting research questions, some of which could provide an evidence-base in support policies that save lives. For more on these next steps, see the package’s introductory <a href="https://itsleeds.github.io/stats19/articles/stats19.html" class="external-link">vignette</a>.</p>
</div>
<div class="section level2">
<h2 id="further-information">Further information<a class="anchor" aria-label="anchor" href="#further-information"></a>
</h2>
<p>The <strong>stats19</strong> package builds on previous work, including:</p>
<ul>
<li>code in the <a href="https://github.com/Robinlovelace/bikeR" class="external-link">bikeR</a> repo underlying an academic paper on collisions involving cyclists</li>
<li>functions in <a href="https://docs.ropensci.org/stplanr/" class="external-link"><strong>stplanr</strong></a> for downloading Stats19 data</li>
<li>updated functions related to the <a href="https://github.com/cyipt/stats19" class="external-link">CyIPT</a> project</li>
</ul>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-lovelace_stats19_2019" class="csl-entry">Lovelace, Robin, Malcolm Morgan, Layik Hama, Mark Padgham, and M Padgham. 2019. “Stats19 A Package for Working with Open Road Crash Data.” <em>Journal of Open Source Software</em> 4 (33): 1181. <a href="https://doi.org/10.21105/joss.01181" class="external-link uri">https://doi.org/10.21105/joss.01181</a>.</div>
<div id="ref-lovelace_who_2016" class="csl-entry">Lovelace, Robin, Hannah Roberts, and Ian Kellar. 2016. “Who, Where, When: The Demographic and Geographic Distribution of Bicycle Crashes in West Yorkshire.” <em>Transportation Research Part F: Traffic Psychology and Behaviour</em>, Bicycling and bicycle safety, 41, Part B. <a href="https://doi.org/10.1016/j.trf.2015.02.010" class="external-link uri">https://doi.org/10.1016/j.trf.2015.02.010</a>.</div>
</div>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=stats19" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/ropensci/stats19/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/ropensci/stats19/issues" class="external-link">Report a bug</a></li>
</ul>
</div>



<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing stats19</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Robin Lovelace <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-5679-6536" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Malcolm Morgan <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-9488-9183" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Layik Hama <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0003-1912-4890" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>
<a href="https://mpadge.github.io/" class="external-link">Mark Padgham</a> <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0003-2172-5265" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>RAC Foundation <br><small class="roles"> Funder </small>  </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="r-universe">
<h2 data-toc-skip>R-universe</h2>
<ul class="list-unstyled">
<li><p><a href="https://ropensci.r-universe.dev/stats19" class="external-link"><img src="https://ropensci.r-universe.dev/badges/stats19" alt="stats19 status badge"></a></p></li>
</ul>
</div>

<div class="software-peer-review">
<h2 data-toc-skip>Software Peer-Review</h2>
<ul class="list-unstyled">
<li><p><a href="https://github.com/ropensci/software-review/issues/266" class="external-link"><img src="https://badges.ropensci.org/266_status.svg" alt="rOpenSci peer-review"></a></p></li>
</ul>
</div>

  </aside>
</div>


    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>

  

  

  </body>
</html>
