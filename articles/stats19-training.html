<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="stats19">
<title>Introduction to R for road safety: an introduction to R and practical exercises • stats19</title>
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to R for road safety: an introduction to R and practical exercises">
<meta property="og:description" content="stats19">
<meta property="og:image" content="https://docs.ropensci.org/stats19/logo.svg">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">stats19</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">3.0.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../articles/stats19.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/blog.html">stats19: a package for road safety research</a>
    <a class="dropdown-item" href="../articles/stats19-training-setup.html">An introduction to road safety analysis with R: setup notes</a>
    <a class="dropdown-item" href="../articles/stats19-training.html">Introduction to R for road safety: an introduction to R and practical exercises</a>
    <a class="dropdown-item" href="../articles/stats19-vehicles.html">Researching vehicles involved in collisions with STATS19 data</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/stats19/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Introduction to R for road safety: an introduction to R and practical exercises</h1>
            <h3 data-toc-skip class="subtitle">Practical exercises based on UK data from the stats19 package, developed by the Institute for Transport Studies, University of Leeds</h3>
                        <h4 data-toc-skip class="author">Robin Lovelace, Malcolm Morgan &amp; Andrea Gilardi</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/stats19/blob/HEAD/vignettes/stats19-training.Rmd" class="external-link"><code>vignettes/stats19-training.Rmd</code></a></small>
      <div class="d-none name"><code>stats19-training.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a>
</h2>
<p>This introductory practical vignette has largely been replaced by the workbook “Reproducible Road Safety Research with R”, which can be found at <a href="https://itsleeds.github.io/rrsrr/" class="external-link uri">https://itsleeds.github.io/rrsrr/</a> and as a PDF at <a href="https://www.racfoundation.org/wp-content/uploads/Reproducible_road_safety_research_with_R_Lovelace_December_2020.pdf" class="external-link">racfoundation.org</a> <span class="citation">(Lovelace 2020)</span>. That workbook is more comprehensive than the content in this tutorial and is the recommended place to learn about using R for reproducible road safety research.</p>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This document provides information, code and exercises to test and improve your R skills with an emphasis on road safety research. It was initially developed to support a <a href="https://www.racfoundation.org/introduction-to-r-for-road-safety" class="external-link">2 day course</a>. The course is based on open road crash records from the <strong>stats19</strong> package <span class="citation">(Lovelace et al. 2019)</span>. However, the content should be of use for anyone working with road crash data that has (at a minimum):</p>
<ul>
<li>A timestamp</li>
<li>A location (or address that can be geocoded)</li>
<li>Attribute data, such as severity of crash, mode of vehicles involved etc.</li>
</ul>
<p>You should type, run and ensure you understand each line of code in this document.</p>
<p>Code and data supporting the content can be found in the package’s GitHub repo at <a href="https://github.com/ropensci/stats19/" class="external-link">github.com/ropensci/stats19</a>. The ‘<a href="https://github.com/ropensci/stats19/issues" class="external-link">issue tracker</a>’ associated with that repo is a good place to ask questions about the course.</p>
<div class="section level3">
<h3 id="prerequisites">Prerequisites<a class="anchor" aria-label="anchor" href="#prerequisites"></a>
</h3>
<p>If you are not experienced with R, it is strongly advised that you read-up on and more importantly <strong>test out</strong> R and RStudio before attempting analyse road crash data with R. See the <code>stats19-training-setup</code> vignette at <a href="https://docs.ropensci.org/stats19/articles/stats19-training-setup.html" class="uri">https://docs.ropensci.org/stats19/articles/stats19-training-setup.html</a> for guidance on getting started with R, RStudio and installing R packages.</p>
<p>The completing the course requires that the following packages, which can be installed with <code><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages()</a></code>, can be loaded as follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://itsleeds.github.io/pct/" class="external-link">pct</a></span><span class="op">)</span>      <span class="co"># access travel data from DfT-funded PCT project </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span>       <span class="co"># spatial vector data classes</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/stats19">stats19</a></span><span class="op">)</span>  <span class="co"># get stats19 data</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/stplanr" class="external-link">stplanr</a></span><span class="op">)</span>  <span class="co"># transport planning tools</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span><span class="co"># packages for 'data science'</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-tmap.github.io/tmap/" class="external-link">tmap</a></span><span class="op">)</span>     <span class="co"># interactive maps</span></span></code></pre></div>
<p>You should type, run and ensure you understand each line of code in this document.</p>
</div>
</div>
<div class="section level2">
<h2 id="r-and-rstudio">R and RStudio<a class="anchor" aria-label="anchor" href="#r-and-rstudio"></a>
</h2>
<p>The learning outcomes of this first session are to learn: RStudio main features and scripts, R objects and functions, subsetting, basic plotting, and getting help.</p>
<p>The first exercise is to open up RStudio and take a look around and identify the main components, shown in the figure below. <strong>Explore each of the main components of RStudio.</strong> Try changing the Global Settings (in the Tools menu) and see RStudio’s short cuts by pressing <code>Alt-Shift-K</code> (or <code>Option+Shift+K</code> on Mac).</p>
<p><img src="https://raw.githubusercontent.com/ITSLeeds/TDS/master/courses/2day/images/rstudio-ui.png" width="70%"></p>
<div class="section level3">
<h3 id="projects-and-scripts">Projects and scripts<a class="anchor" aria-label="anchor" href="#projects-and-scripts"></a>
</h3>
<p>Projects are a way to organise related work together. Each project has its own folder and Rproj file. <strong>Advice: always working from projects will make your life easier!</strong> Start a new project with:</p>
<blockquote>
<p>File &gt; New Project You can choose to create a new directory (folder) or associate a project with an existing directory. Make a new project called stats1-course and save it in a sensible place on your computer. Notice that stats1-course now appears in the top right of RStudio.</p>
</blockquote>
<p>Scripts are the files where R code is stored. <strong>Keeping your code in sensibly named, well organised and reproducible scripts will make your life easier:</strong> you could simply type all our code into the console, but that require retyping commands each time you run it. Instead, code that you want to keep and share should be saved script files, plain text files that have the <code>.R</code> extension.</p>
<p>Make a new script with Flie &gt; New File &gt; Rscript or Ctrl+Shift+N</p>
<p>Save the script and give it a sensible name like <code>stats19-lesson-1.R</code> with File &gt; Save, the save button on the toolbar, or Ctrl+S.</p>
<p><strong>Pro tip:</strong> You can also create new R scripts by typing and running this command in the R console:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/file.edit.html" class="external-link">file.edit</a></span><span class="op">(</span><span class="st">"stats19-lesson-1.R"</span><span class="op">)</span></span></code></pre></div>
<p>Keeping scripts and other files associated with a project in a single folder per project (in an RStudio project) will help you find things you need and develop an efficient workflow.</p>
</div>
<div class="section level3">
<h3 id="writing-and-running-code">Writing and running code<a class="anchor" aria-label="anchor" href="#writing-and-running-code"></a>
</h3>
<p>Let’s start with some basic R operations. Write this code into your new <code>stats19-lesson-1.R</code> R script and execute the result line-by-line by pressing Ctrl+Enter</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span></span>
<span><span class="va">y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">9</span>, <span class="fl">18</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span></code></pre></div>
<p>This code creates two objects, both are vectors of 5 elements, and then plots them (bonus: check their length using the <code><a href="https://rdrr.io/r/base/length.html" class="external-link">length()</a></code> function). Save the script by pressing Ctrl+S.</p>
<p>There are several ways to run code within a script and it is worth becoming familiar with each. Try running the code you saved in the previous section using each of these methods:</p>
<ol style="list-style-type: decimal">
<li>Place the cursor in different places on each line of code and press <code>Ctrl+Enter</code> to run that line of code.</li>
<li>Highlight a block of code or part of a line of code and press <code>Ctrl+Enter</code> to run the highlighted code.</li>
<li>Press <code>Ctrl+Shift+Enter</code> to run all the code in a script.</li>
<li>Press the Run button on the toolbar to run all the code in a script.</li>
<li>Use the function <code><a href="https://rdrr.io/r/base/source.html" class="external-link">source()</a></code> to run all the code in a script e.g. <code>source("stats19-lesson-1.R")</code> <!-- (but don't create an infinite loop!) -->
</li>
</ol>
<p><strong>Pro tip:</strong> Try jumping between the console and the source editor by pressing Ctl+1 and Ctl+2.</p>
</div>
<div class="section level3">
<h3 id="viewing-objects">Viewing Objects<a class="anchor" aria-label="anchor" href="#viewing-objects"></a>
</h3>
<p>Create new objects by typing and running the following code chunk in a new script, e.g. called <code>objects.R</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vehicle_type</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"car"</span>, <span class="st">"bus"</span>, <span class="st">"tank"</span><span class="op">)</span></span>
<span><span class="va">casualty_type</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pedestrian"</span>, <span class="st">"cyclist"</span>, <span class="st">"cat"</span><span class="op">)</span></span>
<span><span class="va">casualty_age</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">20</span>, to <span class="op">=</span> <span class="fl">60</span>, by <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">dark</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">small_matrix</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">24</span>, nrow <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span><span class="va">crashes</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">vehicle_type</span>, <span class="va">casualty_type</span>, <span class="va">casualty_age</span>, <span class="va">dark</span><span class="op">)</span></span></code></pre></div>
<p>We can view the objects in a range of ways:</p>
<ol style="list-style-type: decimal">
<li>Type the name of the object into the console, e.g. <code>crashes</code> and <code>small_matrix</code>, and run that code. Scroll up to see the numbers that didn’t fit on the screen.</li>
<li>Use the <code><a href="https://rdrr.io/r/utils/head.html" class="external-link">head()</a></code> function to view just the first 6 rows e.g. <code>head(small_matrix)</code>
</li>
<li>Bonus: use the <code>n</code> argument in the previous function call to show only the first 2 rows of <code>small_matrix</code>
</li>
<li>Click on the <code>crashes</code> object in the environment tab to View it in a spreadsheet.</li>
<li>Run the command <code>View(vehicle_type)</code>. What just happened?</li>
</ol>
<p>We can also get an overview of an object using a range of functions, including <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>, <code><a href="https://rdrr.io/r/base/class.html" class="external-link">class()</a></code>, <code><a href="https://rdrr.io/r/base/typeof.html" class="external-link">typeof()</a></code>, <code><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim()</a></code>, and <code><a href="https://rdrr.io/r/base/length.html" class="external-link">length()</a></code>.</p>
<p>You can, for example, view a summary of the <code>casualty_age</code> variable by running the following line of code:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">casualty_age</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;      20      30      40      40      50      60</span></span></code></pre></div>
<p><strong>Exercise</strong> try these functions on each of the objects, what results do they give?</p>
<p><strong>Bonus</strong>: Find out the class of the column <code>vehicle_type</code> in the data frame <code>crashes</code> with the command <code>class(crashes$vehicle_type)</code>. Why has it changed? Create a new object called <code>crashes_char</code> that keeps the class of the character vectors intact by using the function <code><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble::tibble()</a></code> (see <a href="https://tibble.tidyverse.org/" class="external-link">tibble.tidyverse.org</a> and Section 4 for details).</p>
</div>
<div class="section level3">
<h3 id="autocompletion">Autocompletion<a class="anchor" aria-label="anchor" href="#autocompletion"></a>
</h3>
<p>RStudio can help you write code by autocompleting it. RStudio will look for similar objects and functions after typing the first three letters of a name.</p>
<p><img src="https://raw.githubusercontent.com/ITSLeeds/TDS/master/courses/2day/images/autocomplete.jpg" width="50%"></p>
<p>When there is more than one option you can select from the list using the mouse or arrow keys. Within a function, you can get a list of arguments by pressing Tab.</p>
<p><img src="https://raw.githubusercontent.com/ITSLeeds/TDS/master/courses/2day/images/fucntionhelp.jpg" width="50%"></p>
</div>
<div class="section level3">
<h3 id="getting-help">Getting help<a class="anchor" aria-label="anchor" href="#getting-help"></a>
</h3>
<p>Every function in R has a help page. You can view the help using <code>?</code> for example <code><a href="https://rdrr.io/r/base/sum.html" class="external-link">?sum</a></code>. Many packages also contain vignettes, these are long form help documents containing examples and guides. <code><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette()</a></code> will show a list of all the vignettes available, or you can show a specific vignette for example <code><a href="https://r-spatial.github.io/sf/articles/sf1.html" class="external-link">vignette(topic = "sf1", package = "sf")</a></code>.</p>
</div>
<div class="section level3">
<h3 id="commenting-code">Commenting Code<a class="anchor" aria-label="anchor" href="#commenting-code"></a>
</h3>
<p>It is good practice to use comments in your code to explain what it does. You can comment code using <code>#</code></p>
<p>For example:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create vector objects (a whole line comment)</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="co"># a seqence of consecutive integers (inline comment)</span></span>
<span><span class="va">y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">9</span>, <span class="fl">18.1</span><span class="op">)</span> </span></code></pre></div>
<p>You can comment/uncomment a whole block of text by selecting it and using <code>Ctrl+Shift+C</code>. <!-- not sure about the next statement so commenting out (RL) --> <!-- and you can reformat a block of code using `Ctrl+Shift  + /`.  --></p>
<p><strong>Pro tip:</strong> You can add a comment section using Ctrl + Shift + R</p>
</div>
<div class="section level3">
<h3 id="the-global-environment">The global environment<a class="anchor" aria-label="anchor" href="#the-global-environment"></a>
</h3>
<p>The Environment tab shows all the objects in your environment, this includes datasets, parameters, and any functions you have created. By default, new objects appear in the Global Environment but you can see other environments with the drop-down menu. For example, each package has its own environment.</p>
<p>Sometimes you wish to remove things from your environment, perhaps because you no longer need them or things are getting cluttered.</p>
<p>You can remove an object with the <code><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm()</a></code> function e.g. <code>rm(x)</code> or <code>rm(x, y)</code> or you can clear your whole environment with the broom button on the Environment Tab.</p>
<ol style="list-style-type: decimal">
<li>Remove the object <code>x</code> that was created in a previous section.</li>
<li>What happens when you try to print the <code>x</code> by entering it into the console?</li>
<li>Try running the following commands in order: <code><a href="https://rdrr.io/r/base/save.html" class="external-link">save.image(); rm(list = ls()); load(".RData")</a></code>. What happened?</li>
<li>How big (how many bytes) is the <code>.RData</code> file in your project’s folder?</li>
<li>Tidy up by removing the <code>.Rdata</code> file with <code>file.remove(".Rdata")</code>.</li>
</ol>
</div>
<div class="section level3">
<h3 id="debugging-code">Debugging Code<a class="anchor" aria-label="anchor" href="#debugging-code"></a>
</h3>
<p>All the code shown so far is reproducible. To test RStudio’s debugging features, let’s write some code that fails, as illustrated in the figure below.</p>
<p><img src="https://raw.githubusercontent.com/ropensci/stats19/master/inst/rstudio-autocomplete.png" width="60%"></p>
<ol style="list-style-type: decimal">
<li>What is the problem with the code shown in the figure?</li>
<li>Create other types of error in the code you have run (e.g. no symetrical brackets and other typos)</li>
<li>Does RStudio pick up on the errors? And what happens when you try to run buggy code?</li>
</ol>
<p><strong>Always address debugging prompts to ensure your code is reproducible</strong></p>
</div>
<div class="section level3">
<h3 id="saving-r-objects">Saving R objects<a class="anchor" aria-label="anchor" href="#saving-r-objects"></a>
</h3>
<p>We have already seen that you can save R scripts. You can also save individual R objects in the RDS format.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">crashes</span>, <span class="st">"crashes.Rds"</span><span class="op">)</span></span></code></pre></div>
<p>We can also read back in our data.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">crashes2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"crashes.Rds"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">crashes</span>, <span class="va">crashes2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>R also supports many other formats, including CSV files, which can be created and imported with the functions <code><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">readr::read_csv()</a></code> and <code><a href="https://readr.tidyverse.org/reference/write_delim.html" class="external-link">readr::write_csv()</a></code> (see also the <a href="https://readr.tidyverse.org/" class="external-link">readr</a> package).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html" class="external-link">write_csv</a></span><span class="op">(</span><span class="va">crashes</span>, <span class="st">"crashes.csv"</span><span class="op">)</span></span>
<span><span class="va">crashes3</span> <span class="op">=</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"crashes.csv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">crashes3</span>, <span class="va">crashes</span><span class="op">)</span> </span></code></pre></div>
<p>Notice that <code>crashes3</code> and <code>crashes</code> are not identical, what has changed? Hint: read the help page associated with <code><a href="https://readr.tidyverse.org/reference/write_delim.html" class="external-link">?readr::write_csv</a></code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="manipulating-r-objects">Manipulating R objects<a class="anchor" aria-label="anchor" href="#manipulating-r-objects"></a>
</h2>
<div class="section level3">
<h3 id="subsetting-by-index-or-name">Subsetting by index or name<a class="anchor" aria-label="anchor" href="#subsetting-by-index-or-name"></a>
</h3>
<p>Subsetting returns part of an R object. It can be done by providing numbers representing the positions of the elements we want (e.g. the 2<sup>nd</sup> element) or with a logical vector, with values associated with <code>TRUE</code> returned. Two dimension object such as matrices and data frames can be subset by rows and columns. Subsetting in base R is done with square brackets <code>[]</code> after the name of an object. <strong>Run the following commands to practice subsetting.</strong></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">casualty_age</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span> <span class="co"># second and third casualty_age</span></span>
<span><span class="va">crashes</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="op">]</span> <span class="co"># first and second row of crashes</span></span>
<span><span class="va">crashes</span><span class="op">$</span><span class="va">vehicle_type</span> <span class="co"># returns just one column</span></span>
<span><span class="va">crashes</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"casualty_type"</span>, <span class="st">"casualty_age"</span><span class="op">)</span><span class="op">]</span> <span class="co"># first and third columns</span></span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Use the <code>$</code> operator to print the <code>dark</code> column of <code>crashes</code>.</li>
<li>Subset the crashes with the <code>[,]</code> syntax so that only the first and third columns of <code>crashes</code> are returned.</li>
<li>Return the 2<sup>nd</sup> row and the 3<sup>rd</sup> column of the <code>crashes</code> dataset.</li>
<li>Return the 2<sup>nd</sup> row and the columns 2:3 of the <code>crashes</code> dataset.</li>
<li>
<strong>Bonus</strong>: what is the <code><a href="https://rdrr.io/r/base/class.html" class="external-link">class()</a></code> of the objects created by each of the previous exercises?</li>
</ol>
</div>
<div class="section level3">
<h3 id="subsetting-by-values">Subsetting by values<a class="anchor" aria-label="anchor" href="#subsetting-by-values"></a>
</h3>
<p>It is also possible to subset objects by the values of their elements. This works because the <code>[</code> operator accepts logical vectors returned by queries such as ‘is it less than 3?’ (<code>x &lt; 3</code> in R) and ‘was it light?’ (<code>crashes$dark == FALSE</code>), as demonstrated below:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span> <span class="co"># 1st, 3rd, and 5th element in x</span></span>
<span><span class="va">x</span><span class="op">[</span><span class="va">x</span> <span class="op">==</span> <span class="fl">5</span><span class="op">]</span> <span class="co"># only when x == 5 (notice the use of double equals)</span></span>
<span><span class="va">x</span><span class="op">[</span><span class="va">x</span> <span class="op">&lt;</span> <span class="fl">3</span><span class="op">]</span> <span class="co"># less than 3</span></span>
<span><span class="va">x</span><span class="op">[</span><span class="va">x</span> <span class="op">&lt;</span> <span class="fl">3</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0</span> <span class="co"># assign specific elements</span></span>
<span><span class="va">casualty_age</span><span class="op">[</span><span class="va">casualty_age</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">6</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span> <span class="co"># just the ages that are a multiple of 6</span></span>
<span><span class="va">crashes</span><span class="op">[</span><span class="va">crashes</span><span class="op">$</span><span class="va">dark</span> <span class="op">==</span> <span class="cn">FALSE</span>, <span class="op">]</span></span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Subset the <code>casualty_age</code> object using the inequality (<code>&lt;</code>) so that only elements less than 50 are returned.</li>
<li>Subset the <code>crashes</code> data frame so that only tanks are returned using the <code>==</code> operator.</li>
<li>
<strong>Bonus</strong>: assign the age of all tanks to 61.</li>
</ol>
</div>
<div class="section level3">
<h3 id="dealing-with-nas-and-recoding">Dealing with NAs and recoding<a class="anchor" aria-label="anchor" href="#dealing-with-nas-and-recoding"></a>
</h3>
<p>R objects can have a value of NA. This is how R represents missing data.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">5</span>, <span class="cn">NA</span>, <span class="fl">7</span><span class="op">)</span></span></code></pre></div>
<p>NA values are common in real-world data but can cause trouble, for example</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="co"># result is NA</span></span></code></pre></div>
<p>Some functions can be told to ignore NA values.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">z</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># result is equal to 4 + 5 + 7</span></span></code></pre></div>
<p>You can find NAs using the <code><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na()</a></code> function, and then remove them</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="va">z_nona</span> <span class="op">=</span> <span class="va">z</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">]</span> <span class="co"># note the use of the not operator !</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span></code></pre></div>
<p>If you remove records with NAs be warned: the average of a value excluding NAs may not be representative.</p>
</div>
<div class="section level3">
<h3 id="changing-class">Changing class<a class="anchor" aria-label="anchor" href="#changing-class"></a>
</h3>
<p>Sometimes you may want to change the class of an object. This is called class coercion, and can be done with functions such as <code><a href="https://rdrr.io/r/base/logical.html" class="external-link">as.logical()</a></code>, <code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric()</a></code> and <code><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix()</a></code>.</p>
<ol style="list-style-type: decimal">
<li>Coerce the <code>vehicle_type</code> column of <code>crashes</code> to the class <code>character</code>.</li>
<li>Coerce the <code>crashes</code> object into a matrix. What happened to the values?</li>
<li>
<strong>Bonus:</strong> What is the difference between the output of <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> on <code>character</code> and <code>factor</code> variables?</li>
</ol>
</div>
<div class="section level3">
<h3 id="recoding-values">Recoding values<a class="anchor" aria-label="anchor" href="#recoding-values"></a>
</h3>
<p>Often it is useful to ‘recode’ values. In the raw STATS19 files, for example, -1 means NA. There are many ways to recode values in R, the simplest and most mature of which is the use of factors, as shown below:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">l</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span><span class="op">)</span> <span class="co"># labels in ascending order</span></span>
<span><span class="va">z_factor</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">z</span>, labels <span class="op">=</span> <span class="va">l</span><span class="op">)</span></span>
<span><span class="va">z_charcter</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">z_factor</span><span class="op">)</span></span>
<span><span class="va">z_charcter</span></span>
<span><span class="co">#&gt; [1] "a" "b" NA  "a" "c"</span></span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Recode <code>z</code> to Slight, Serious and Fatal for 1:3 respectively.</li>
<li>Bonus: read the help file at <code><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">?dplyr::case_when</a></code> and try to recode the values using this function.</li>
</ol>
</div>
<div class="section level3">
<h3 id="now-you-are-ready-to-use-r">Now you are ready to use R<a class="anchor" aria-label="anchor" href="#now-you-are-ready-to-use-r"></a>
</h3>
<p><strong>Bonus: reproduce the following plot</strong></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eyes</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.3</span>, <span class="fl">4</span>, <span class="fl">3.7</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">eyes</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">eyes</span>, ncol <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">mouth</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2.5</span>, <span class="fl">1.3</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">3.5</span>, <span class="fl">1.3</span>, <span class="fl">4</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">mouth</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">mouth</span>, ncol <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">eyes</span>, type <span class="op">=</span> <span class="st">"p"</span>, main <span class="op">=</span> <span class="st">"RRR!"</span>, cex <span class="op">=</span> <span class="fl">2</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">mouth</span>, type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="stats19-training_files/figure-html/smile-1.png" width="30%" style="display: block; margin: auto;"></p>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="section level2">
<h2 id="r-packages">R Packages<a class="anchor" aria-label="anchor" href="#r-packages"></a>
</h2>
<div class="section level3">
<h3 id="what-are-packages">What are packages?<a class="anchor" aria-label="anchor" href="#what-are-packages"></a>
</h3>
<p>R has over 15,000 packages (effectively plugins for base R), extending it in almost every direction of statistics and computing. Packages provide additional functions, data and documentation. They are very often written by subject-matter experts and therefore tend to fit well with the workflow of the analyst in that particular specialism. There are two main stages to using a package: installing it and loading it. A third stage is updating it, this is also important.</p>
<!-- installing it... -->
<p>Install new packages from <a href="https://cran.r-project.org/" class="external-link">The Comprehensive R Archive Network</a> with the command <code><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages()</a></code> (or <code><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">remotes::install_github()</a></code> to install from GitHub). Update packages with the command <code>update.package()</code> or in Tools &gt; Check for Package Updates in RStudio. You only need to install a package once. <!-- **Note: avoid `install.packages()` within a script** --> <!-- Packages only need to be installed once. --> <!-- You can use `remotes::install_cran()` or `remotes::install_github()` to only install a package if it is not yet installed and up-to-date (note: you only need to use one of these): --></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"sf"</span><span class="op">)</span></span>
<span><span class="co"># remotes::install_github("r-spatial/sf")</span></span></code></pre></div>
<!-- now talk about loading packages -->
<p>Installed packages are loaded with the command <code><a href="https://rdrr.io/r/base/library.html" class="external-link">library()</a></code>. Usually, the package will load silently. In some cases the package will provide a message, as illustrated below.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Linking to GEOS 3.10.2, GDAL 3.4.1, PROJ 8.2.1; sf_use_s2() is TRUE</span></span></code></pre></div>
<p>To use a function in a package without first loading the package, use double colons, as shown below (this calls the <code><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble()</a></code> function from the <code>tibble</code> package).</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">crashes_tibble</span> <span class="op">=</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  <span class="va">vehicle_type</span>,</span>
<span>  <span class="va">casualty_type</span>,</span>
<span>  <span class="va">casualty_age</span>,</span>
<span>  <span class="va">dark</span></span>
<span><span class="op">)</span></span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Take a look in the Packages tab in the Files pane in RStudio (bottom right by default).</li>
<li>What version of the <code>stats19</code> package is installed on your computer?</li>
<li>Run the command <code><a href="https://rdrr.io/r/utils/update.packages.html" class="external-link">update.packages()</a></code>. What happens? Why?</li>
</ol>
</div>
<div class="section level3">
<h3 id="ggplot2">ggplot2<a class="anchor" aria-label="anchor" href="#ggplot2"></a>
</h3>
<p>Let’s take a look at a particular package. <code>ggplot2</code> is a generic plotting package that is part of the <a href="https://www.tidyverse.org/" class="external-link">‘tidyverse’</a> meta-package, which is an “opinionated collection of R packages designed for data science”. All packages in the tidyverse “share an underlying design philosophy, grammar, and data structures”. <code>ggplot2</code> is flexible, popular, and has dozens of add-on packages which build on it, such as <code>gganimate</code>. To plot non-spatial data, it works as follows (see figure below, left for result):</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">crashes</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">casualty_type</span>, y <span class="op">=</span> <span class="va">casualty_age</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Note that the <code>+</code> operator adds layers onto one another.</p>
<ol style="list-style-type: decimal">
<li>Install a package that build on <code>ggplot2</code> that begins with with <code>gg</code>. Hint: enter <code>install.packages(gg)</code> and hit Tab when your cursor is between the <code>g</code> and the <code>)</code>.</li>
<li>Open a help page in the newly installed package with the <code>?package_name::function()</code> syntax.</li>
<li>Attach the package.</li>
<li>
<strong>Bonus:</strong> try using functionality from the new ‘gg’ package building on the example above to create plots like those shown below (hint: the right plot below uses the economist theme from the <code>ggthemes</code> package, try other themes).</li>
</ol>
<p><img src="https://raw.githubusercontent.com/ropensci/stats19/b4c40ad4c134853007493a9eac116b00acd4ec5a/inst/ggtheme-plot.png" width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="dplyr-and-pipes">dplyr and pipes<a class="anchor" aria-label="anchor" href="#dplyr-and-pipes"></a>
</h3>
<p>Another useful package in the tidyverse is <code>dplyr</code>. It provides functions for manipulating data frames and using the pipe operator <code>%&gt;%</code>. The pipe puts the output of one command into the first argument of the next, as shown below (note the results are the same):</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">crashes</span><span class="op">)</span>       </span>
<span><span class="co">#&gt; [1] "data.frame"</span></span>
<span><span class="va">crashes</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "data.frame"</span></span></code></pre></div>
<p>Useful <code>dplyr</code> functions are demonstrated below.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">crashes</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">casualty_age</span> <span class="op">&gt;</span> <span class="fl">50</span><span class="op">)</span> <span class="co"># filter rows</span></span>
<span><span class="va">crashes</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">casualty_type</span><span class="op">)</span> <span class="co"># select just one column</span></span>
<span><span class="va">crashes</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">dark</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>mean_age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">casualty_age</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Use <code>dplyr</code> to filter row in which <code>casualty_age</code> is less than 18, and then 28.</li>
<li>Use the <code>arrange</code> function to sort the <code>crashes</code> object in descending order of age (hint: see the <code><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">?arrange</a></code> help page).</li>
<li>Read the help page of <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">dplyr::mutate()</a></code>. What does the function do?</li>
<li>Use the mutate function to create a new variable, <code>birth_year</code>, in the <code>crashes</code> data.frame which is defined as the current year minus their age.</li>
<li>
<strong>Bonus:</strong> Use the <code>%&gt;%</code> operator to filter the output from the previous exercise so that only observations with <code>birth_year</code> after 1969 are returned.</li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="temporal-data">Temporal data<a class="anchor" aria-label="anchor" href="#temporal-data"></a>
</h2>
<p>For the analysis and manipulation of temporal data we will first load the R package <code>lubridate</code>:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span></code></pre></div>
<p>The simplest example of a Date object that we can analyze is just the current date, i.e.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/now.html" class="external-link">today</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "2024-03-10"</span></span></code></pre></div>
<p>We can manipulate this object using several <code>lubridate</code> functions to extract the current day, month, year, weekday and so on…</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/now.html" class="external-link">today</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/day.html" class="external-link">day</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html" class="external-link">month</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/year.html" class="external-link">year</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/weekday.POSIXt.html" class="external-link">weekdays</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<p>Exercises:</p>
<ol style="list-style-type: decimal">
<li>Look at the help page of the function <code>month</code> to see how it is possible to extract the current month as character vector</li>
<li>Look at other functions in lubridate to extract the current weekday as a number, the week of year and the day of the year</li>
</ol>
<p>Date variables are often stored simply as a character vectors. This is a problem, since R is not always smart enough to distinguish between character vectors representing Dates. <code>lubridate</code> provides functions that can translate a wide range of date encodings such as <code><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd()</a></code>, which extracts the Year Month and Day from a character string, as demonstrated below.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2019-10-17"</span><span class="op">)</span> <span class="co"># works</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2019 10 17"</span><span class="op">)</span> <span class="co"># fails</span></span>
<span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2019 10 17"</span><span class="op">)</span> <span class="co"># works</span></span>
<span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">dmy</a></span><span class="op">(</span><span class="st">"17/10/2019"</span><span class="op">)</span> <span class="co"># works</span></span></code></pre></div>
<p>Import function such as <code>read_csv</code> try to recognize the Date variables. Sometimes this fails. You can manually create Date objects, as shown below.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2009-01-01"</span>, <span class="st">"2009-02-02"</span>, <span class="st">"2009-03-03"</span><span class="op">)</span></span>
<span><span class="va">x_date</span> <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="va">x_date</span></span>
<span><span class="co">#&gt; [1] "2009-01-01" "2009-02-02" "2009-03-03"</span></span></code></pre></div>
<p>Exercises:</p>
<ol style="list-style-type: decimal">
<li>Extract the day, the year-day, the month and the weekday (as a non-abbreviated character vector) of each element of <code>x_date</code>.</li>
<li>Convert <code>"09/09/93"</code> into a date object and extract its weekday.</li>
<li>
<strong>Bonus:</strong> Read the help page of <code>as.Date</code> and <code>strptime</code> for further details on base R functions for dates.</li>
<li>
<strong>Bonus:</strong> Read the Chapter 16 of <a href="https://r4ds.had.co.nz/dates-and-times.html" class="external-link">R for Data Science book</a> for further details on <code>lubridate</code> package.</li>
</ol>
<p>We can use Dates also for subsetting events in a dataframe. For example, if we define <code>x_date</code> as before and add it to the <code>crash</code> dataset, i.e.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">crashes</span><span class="op">$</span><span class="va">casualty_day</span> <span class="op">=</span> <span class="va">x_date</span></span></code></pre></div>
<p>then we can subset events using Dates. For example</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">crashes</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/day.html" class="external-link">day</a></span><span class="op">(</span><span class="va">casualty_day</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">7</span><span class="op">)</span> <span class="co"># the events that ocurred in the first week of the month</span></span>
<span><span class="co">#&gt;   vehicle_type casualty_type casualty_age  dark casualty_day</span></span>
<span><span class="co">#&gt; 1          car    pedestrian           20  TRUE   2009-01-01</span></span>
<span><span class="co">#&gt; 2          bus       cyclist           40 FALSE   2009-02-02</span></span>
<span><span class="co">#&gt; 3         tank           cat           60  TRUE   2009-03-03</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">crashes</span>, <span class="fu"><a href="https://rdrr.io/r/base/weekday.POSIXt.html" class="external-link">weekdays</a></span><span class="op">(</span><span class="va">casualty_day</span><span class="op">)</span> <span class="op">==</span> <span class="st">"Monday"</span><span class="op">)</span> <span class="co"># the events occurred on monday</span></span>
<span><span class="co">#&gt;   vehicle_type casualty_type casualty_age  dark casualty_day</span></span>
<span><span class="co">#&gt; 1          bus       cyclist           40 FALSE   2009-02-02</span></span></code></pre></div>
<p>Exercises:</p>
<ol style="list-style-type: decimal">
<li>Select only the events (rows in <code>crashes</code>) that occurred in January</li>
<li>Select only the events that ocurred in an odd year-day</li>
<li>Select only the events that ocurred in a leap-year (HINT: check the function <code>leap_year</code>)</li>
<li>Select only the events that ocurred during the weekend or in June</li>
<li>Select only the events that ocurred during the weekend and in June</li>
<li>Count how many events ocurred during each day of the week.</li>
</ol>
<p>Now we’ll take a look at the time components of a Date. Using the function <code>hms</code> (acronym for Hour Minutes Seconds) and its subfunctions such as <code>hm</code> or <code>ms</code>, we can parse a character vector representing several times as an Hour object (which is tecnically called a Period object).</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"18:23:35"</span>, <span class="st">"00:00:01"</span>, <span class="st">"12:34:56"</span><span class="op">)</span></span>
<span><span class="va">x_hour</span> <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/hms.html" class="external-link">hms</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="va">x_hour</span></span>
<span><span class="co">#&gt; [1] "18H 23M 35S" "1S"          "12H 34M 56S"</span></span></code></pre></div>
<p>We can manipulate these objects using several <code>lubridate</code> functions to extract the hour component, the minutes and so on:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/hour.html" class="external-link">hour</a></span><span class="op">(</span><span class="va">x_hour</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 18  0 12</span></span>
<span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/minute.html" class="external-link">minute</a></span><span class="op">(</span><span class="va">x_hour</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 23  0 34</span></span>
<span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/second.html" class="external-link">second</a></span><span class="op">(</span><span class="va">x_hour</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 35  1 56</span></span></code></pre></div>
<p>If the Hour data do not specify the seconds, then we just have to use a subfunction of <code>hms</code>, namely <code>hm</code>, and everything works as before.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"18:23"</span>, <span class="st">"00:00"</span>, <span class="st">"12:34"</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">x_hour</span> <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/hms.html" class="external-link">hm</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "18H 23M 0S" "0S"         "12H 34M 0S"</span></span></code></pre></div>
<p>We can use Hour data also for subsetting events, like we did for Dates. Let’s add a new column to crashes data,</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">crashes</span><span class="op">$</span><span class="va">casualty_hms</span> <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/hms.html" class="external-link">hms</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"18:23:35"</span>, <span class="st">"00:00:01"</span>, <span class="st">"12:34:56"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">crashes</span><span class="op">$</span><span class="va">casualty_hour</span> <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/hour.html" class="external-link">hour</a></span><span class="op">(</span><span class="va">crashes</span><span class="op">$</span><span class="va">casualty_hms</span><span class="op">)</span></span></code></pre></div>
<p>Exercises:</p>
<ol style="list-style-type: decimal">
<li>Filter only the events that ocurred after midday (i.e. the PM events). Hint: your answer may include <code>&gt;= 12</code>.</li>
<li>Filter only the events that ocurred between 15:00 and 19:00 <!-- 1. Round all hours to the next hour. Hint: Look at the help page of the `round_date` function.  -->
</li>
<li>
<strong>Bonus (difficult):</strong> run the following code, which downloades data for car crashes occurred during 2022.</li>
</ol>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/stats19">stats19</a></span><span class="op">)</span></span>
<span><span class="va">crashes_2022</span> <span class="op">=</span> <span class="fu">stats19</span><span class="fu">::</span><span class="fu"><a href="../reference/get_stats19.html">get_stats19</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2022</span>, type <span class="op">=</span> <span class="st">"ac"</span><span class="op">)</span></span>
<span><span class="va">crashes_2022</span></span></code></pre></div>
<p>Extract the weekday from the variable called <code>date</code>. How many crashes happened on Monday?</p>
<p><strong>Advanced challenge:</strong> calculate how many crashes occurred for each day of the week. Then plot it with ggplot2. Repeat the same exercises extracting the hour of the car accident from the variable called time. How would you combine the two informations in a single plot?</p>
</div>
<div class="section level2">
<h2 id="spatial-data">Spatial data<a class="anchor" aria-label="anchor" href="#spatial-data"></a>
</h2>
<div class="section level3">
<h3 id="sf-objects">sf objects<a class="anchor" aria-label="anchor" href="#sf-objects"></a>
</h3>
<p>All road crashes happen somewhere and, in the UK at least, all collisions recorded by the police are given geographic coordinates, something that can help prioritise interventions to save lives by intervening in and around ‘crash hotspots’. R has strong geographic data capabilities, with the <code>sf</code> package provides a generic class for spatial vector data: points, lines and polygons, are represented in <code>sf</code> objects as a special ‘geometry column’, typically called ‘geom’ or ‘geometry’, extending the data frame class we’ve already seen in <code>crashes</code>.</p>
<p>Create an <code>sf</code> data frame called <code>crashes_sf</code> as follows:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span> <span class="co"># load the sf package for working with spatial data</span></span>
<span><span class="va">crashes_sf</span> <span class="op">=</span> <span class="va">crashes</span> <span class="co"># create copy of crashes dataset</span></span>
<span><span class="va">crashes_sf</span><span class="op">$</span><span class="va">longitude</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.3</span>, <span class="op">-</span><span class="fl">1.2</span>, <span class="op">-</span><span class="fl">1.1</span><span class="op">)</span></span>
<span><span class="va">crashes_sf</span><span class="op">$</span><span class="va">latitude</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50.7</span>, <span class="fl">50.7</span>, <span class="fl">50.68</span><span class="op">)</span></span>
<span><span class="va">crashes_sf</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">crashes_sf</span>, coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"longitude"</span>, <span class="st">"latitude"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span></span>
<span><span class="co"># plot(crashes_sf[1:4]) # basic plot</span></span>
<span><span class="co"># mapview::mapview(crashes_sf) # for interactive map</span></span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Plot only the geometry column of <code>crashes_sf</code> (hint: the solution may contain <code>$geometry</code>). If the result is like the figure below, congratulations, it worked!).</li>
<li>Plot <code>crashes_sf</code>, only showing the age variable.</li>
<li>Plot the 2<sup>nd</sup> and 3<sup>rd</sup> crashes, showing which happened in the dark.</li>
<li>
<strong>Bonus</strong>: How far are the points apart (hint: <code>sf</code> functions begin with <code>st_</code>)?</li>
<li>
<strong>Bonus</strong>: Near which settlement did the tank runover the cat?</li>
</ol>
<p><img src="stats19-training_files/figure-html/crashes-sf-ex-1.png" width="30%"><img src="stats19-training_files/figure-html/crashes-sf-ex-2.png" width="30%"><img src="stats19-training_files/figure-html/crashes-sf-ex-3.png" width="30%"></p>
</div>
<div class="section level3">
<h3 id="reading-and-writing-spatial-data">Reading and writing spatial data<a class="anchor" aria-label="anchor" href="#reading-and-writing-spatial-data"></a>
</h3>
<p>You can read and write spatial data with <code><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">read_sf()</a></code> and <code><a href="https://r-spatial.github.io/sf/reference/st_write.html" class="external-link">write_sf()</a></code>, as shown below (see <code><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">?read_sf</a></code>).</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_write.html" class="external-link">write_sf</a></span><span class="op">(</span><span class="va">zones</span>, <span class="st">"zones.geojson"</span><span class="op">)</span> <span class="co"># save geojson file</span></span>
<span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_write.html" class="external-link">write_sf</a></span><span class="op">(</span><span class="va">zones</span>, <span class="st">"zmapinfo"</span>, driver <span class="op">=</span> <span class="st">"MapInfo file"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">read_sf</a></span><span class="op">(</span><span class="st">"zmapinfo"</span><span class="op">)</span> <span class="co"># read in mapinfo file</span></span></code></pre></div>
<p>See <a href="https://r.geocompx.org/read-write.html" class="external-link">Chapter 6</a> of Geocomputation with R for further information.</p>
</div>
<div class="section level3">
<h3 id="sf-polygons">sf polygons<a class="anchor" aria-label="anchor" href="#sf-polygons"></a>
</h3>
<p>Note: the code beyond this point is not evaluated in the vignette:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html" class="external-link">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>eval <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><code>sf</code> objects can also represent administrative zones. This is illustrated below with reference to <code>zones</code>, a spatial object representing the Isle of Wight, that we will download using the <code>pct</code> package (note: the <code>[1:9]</code> appended to the function selects only the first 9 columns).</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zones</span> <span class="op">=</span> <span class="fu">pct</span><span class="fu">::</span><span class="fu"><a href="https://itsleeds.github.io/pct/reference/get_pct_zones.html" class="external-link">get_pct_zones</a></span><span class="op">(</span><span class="st">"isle-of-wight"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span></span></code></pre></div>
<ol style="list-style-type: decimal">
<li>What is the class of the <code>zones</code> object?</li>
<li>What are its column names?</li>
<li>Print its first 2 rows and columns 6:8 (the result is below).</li>
</ol>
</div>
<div class="section level3">
<h3 id="spatial-subsetting-and-sf-plotting">Spatial subsetting and sf plotting<a class="anchor" aria-label="anchor" href="#spatial-subsetting-and-sf-plotting"></a>
</h3>
<p>Like index and value subsetting, spatial subsetting can be done with the <code>[</code> notation. Subset the <code>zones</code> that contain features in <code>crashes_sf</code> as follows:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zones_containing_crashes</span> <span class="op">=</span> <span class="va">zones</span><span class="op">[</span><span class="va">crashes_sf</span>, <span class="op">]</span></span></code></pre></div>
<p>To plot a new layer on top of an existing <code>sf</code> plot, use the <code>add = TRUE</code> argument. Remember to plot only the <code>geometry</code> column of objects to avoid multiple maps. Colours can be set with the <code>col</code> argument.</p>
<ol style="list-style-type: decimal">
<li>Plot the geometry of the zones, with the zones containing crashes overlaid on top in red.</li>
<li>Plot the zone containing the 2<sup>nd</sup> crash in blue.</li>
<li>
<strong>Bonus:</strong> plot all zones that intersect with a zone containing crashes, with the actual crash points plotted in black.</li>
</ol>
</div>
<div class="section level3">
<h3 id="geographic-joins">Geographic joins<a class="anchor" aria-label="anchor" href="#geographic-joins"></a>
</h3>
<p>Geographic joins involve assigning values from one object to a new column in another, based on the geographic relationship between them. With <code>sf</code> objects it works as follows:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zones_joined</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_join.html" class="external-link">st_join</a></span><span class="op">(</span><span class="va">zones</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">crashes_sf</span><span class="op">)</span></span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Plot the <code>casualty_age</code> variable of the new <code>zones_joined</code> object (see the figure below to verify the result).</li>
<li>How many zones are returned in the previous command?</li>
<li>Select only the <code>geo_code</code> column from the <code>zones</code> and the <code>dark</code> column from <code>crashes_sf</code> and use the <code>left = FALSE</code> argument to return only zones in which crashes occured. Plot the result.</li>
</ol>
<p>See <a href="https://r.geocompx.org/spatial-operations.html" class="external-link">Chapter 4</a> of Geocomputation with R <span class="citation">(Lovelace, Nowosad, and Muenchow 2019)</span> for further information on geographic joins.</p>
</div>
<div class="section level3">
<h3 id="crss">CRSs<a class="anchor" aria-label="anchor" href="#crss"></a>
</h3>
<p>Get and set Coordinate Reference Systems (CRSs) with the command <code><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs()</a></code>. Transform CRSs with the command <code><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform()</a></code>, as demonstrated in the code chunk below, which converts the ‘lon/lat’ geographic CRS of <code>crashes_sf</code> into the projected CRS of the British National Grid:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">crashes_osgb</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">crashes_sf</span>, <span class="fl">27700</span><span class="op">)</span></span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Try to subset the zones with the <code>crashes_osgb</code>. What does the error message say?</li>
<li>Create <code>zones_osgb</code> by transforming the <code>zones</code> object.</li>
<li>
<strong>Bonus:</strong> use <code><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs()</a></code> to find out the units measurement of the British National Grid?</li>
</ol>
<p>For more information on CRSs see <a href="https://r.geocompx.org/reproj-geo-data.html" class="external-link">Chapter 6</a> of Geocompuation with R.</p>
</div>
<div class="section level3">
<h3 id="buffers">Buffers<a class="anchor" aria-label="anchor" href="#buffers"></a>
</h3>
<p>Buffers are polygons surrounding geometries of a (usually) fixed distance. Currently buffer operations in R only work on objects with projected CRSs.</p>
<ol style="list-style-type: decimal">
<li>Find out and read the help page of <code>sf</code>’s buffer function.</li>
<li>Create an object called <code>crashes_1km_buffer</code> representing the area within 1 km of the crashes.</li>
<li>
<strong>Bonus:</strong> try creating buffers on the geographic version of the <code>crashes_sf</code> object. What happens?</li>
</ol>
</div>
<div class="section level3">
<h3 id="attribute-operations-on-sf-objects">Attribute operations on sf objects<a class="anchor" aria-label="anchor" href="#attribute-operations-on-sf-objects"></a>
</h3>
<p>Because <code>sf</code> objects are <code>data.frame</code>s, we can do non-spatial operations on them. Try the following attribute operations on the <code>zones</code> data.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load example dataset if it doesn't already exist</span></span>
<span><span class="va">zones</span> <span class="op">=</span> <span class="fu">pct</span><span class="fu">::</span><span class="fu"><a href="https://itsleeds.github.io/pct/reference/get_pct_zones.html" class="external-link">get_pct_zones</a></span><span class="op">(</span><span class="st">"isle-of-wight"</span><span class="op">)</span></span>
<span><span class="va">sel</span> <span class="op">=</span> <span class="va">zones</span><span class="op">$</span><span class="va">all</span> <span class="op">&gt;</span> <span class="fl">3000</span>  <span class="co"># create a subsetting object</span></span>
<span><span class="va">zones_large</span> <span class="op">=</span> <span class="va">zones</span><span class="op">[</span><span class="va">sel</span>, <span class="op">]</span> <span class="co"># subset areas with a popualtion over 100,000</span></span>
<span><span class="va">zones_2</span> <span class="op">=</span> <span class="va">zones</span><span class="op">[</span><span class="va">zones</span><span class="op">$</span><span class="va">geo_name</span> <span class="op">==</span> <span class="st">"Isle of Wight 002"</span>,<span class="op">]</span> <span class="co"># subset based on 'equality' query</span></span>
<span><span class="va">zones_first_and_third_column</span> <span class="op">=</span> <span class="va">zones</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">zones_just_all</span> <span class="op">=</span> <span class="va">zones</span><span class="op">[</span><span class="st">"all"</span><span class="op">]</span></span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Practice subsetting techniques you have learned on the <code>sf data.frame</code> object <code>zones</code>:
<ol style="list-style-type: decimal">
<li>Create an object called <code>zones_small</code> which contains only regions with less than 3000 people in the <code>all</code> column</li>
<li>Create a selection object called <code>sel_high_car</code> which is <code>TRUE</code> for regions with above median numbers of people who travel by car and <code>FALSE</code> otherwise</li>
<li>Create an object called <code>zones_foot</code> which contains only the foot attribute from <code>zones</code>
</li>
<li>Bonus: plot <code>zones_foot</code> using the function <code>plot</code> to show where walking is a popular mode of travel to work</li>
<li>Bonus: bulding on your answers to previous questions, use <code><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter()</a></code> from the <code>dplyr</code> package to subset small regions where car use is high.</li>
</ol>
</li>
<li>Bonus: What is the population density of each region (hint: you may need to use the functions <code><a href="https://r-spatial.github.io/sf/reference/geos_measures.html" class="external-link">st_area()</a></code>, <code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric()</a></code> and use the ‘all’ column)?</li>
<li>Bonus: Which zone has the highest percentage of people who cycle?</li>
</ol>
</div>
<div class="section level3">
<h3 id="matching-roads-to-crashes">Matching roads to crashes<a class="anchor" aria-label="anchor" href="#matching-roads-to-crashes"></a>
</h3>
<p>I think you forgot something here. For example we could introduce <code>st_nearest_feature</code>? Or counting using <code>st_within</code> and <code>st_buffer</code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="visualising-spatial-datasets">Visualising spatial datasets<a class="anchor" aria-label="anchor" href="#visualising-spatial-datasets"></a>
</h2>
<p>So far we have used the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function to make maps. That’s fine for basic visualisation, but for publication-quality maps, we recommend using <code>tmap</code> (see Chapter 8 of Geocomputation with R for reasons and alternatives). Load the package as follows:</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-tmap.github.io/tmap/" class="external-link">tmap</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tmap_mode.html" class="external-link">tmap_mode</a></span><span class="op">(</span><span class="st">"plot"</span><span class="op">)</span></span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Create the following plots using <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> and <code>tm_shape() + tm_polygons()</code> functions (note: the third figure relies on setting <code>tmap_mode("view")</code>.</li>
<li>Add an additional layer to the interactive map showing the location of crashes, using marker and dot symbols.</li>
<li>Bonus: Change the default basemap (hint: you may need to search in the package documentation or online for the solution).</li>
</ol>
</div>
<div class="section level2">
<h2 id="analysing-point-data-from-stats19">Analysing point data from stats19<a class="anchor" aria-label="anchor" href="#analysing-point-data-from-stats19"></a>
</h2>
<p>Based on the saying “don’t run before you can walk”, we’ve learned the vital foundations of R before tackling a real dataset. Temporal and spatial attributes are key to road crash data, hence the emphasis on <code>lubridate</code> and <code>sf</code>. Visualisation is key to understanding and policy influence, which is where <code>tmap</code> comes in. With these solid foundations, plus knowledge of how to ask for help (read R’s internal help functions, ask colleagues, create new comments on online forums/GitHub, generally in that order of priority), you are ready to test the methods on some real data.</p>
<p>Before doing so, take a read of the <code>stats19</code> vignette, which can be launched as follows:</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"stats19"</span><span class="op">)</span> <span class="co"># view all vignettes available on stats19</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"stats19"</span><span class="op">)</span> <span class="co"># view the introductory vignette</span></span></code></pre></div>
<p>This should now be sufficient to tackle the following exercises:</p>
<ol style="list-style-type: decimal">
<li>Download and plot all crashes reported in Great Britain in 2018 (hint: see <a href="https://docs.ropensci.org/stats19/articles/stats19.html">the stats19 vignette</a>)</li>
<li>Find the function in the <code>stats19</code> package that converts a <code>data.frame</code> object into an <code>sf</code> data frame. Use this function to convert the road crashes into an <code>sf</code> object, called <code>crashes_sf</code>, for example.</li>
<li>Filter crashes that happened in the Isle of Wight based on attribute data (hint: the relevant column contains the word <code>local</code>)</li>
<li>Filter crashes happened in the Isle of Wight using geographic subsetting (hint: remember <code><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs()</a></code>?)</li>
<li>
<strong>Bonus:</strong> Which type of subsetting yielded more results and why?</li>
<li>
<strong>Bonus:</strong> how many crashes happened in each zone?</li>
<li>Create a new column called <code>month</code> in the crash data using the function <code><a href="https://lubridate.tidyverse.org/reference/month.html" class="external-link">lubridate::month()</a></code> and the <code>date</code> column.</li>
<li>Create an object called <code>a_zones_may</code> representing all the crashes that happened in the Isle of Wight in the month of May</li>
<li>Bonus: Calculate the average (<code>mean</code>) speed limit associated with each crash that happened in May across the zones of the Isle of Wight (the result is shown in the map)</li>
</ol>
</div>
<div class="section level2">
<h2 id="analysing-crash-data-on-road-networks">Analysing crash data on road networks<a class="anchor" aria-label="anchor" href="#analysing-crash-data-on-road-networks"></a>
</h2>
<p>Road network data can be accessed from a range of sources, including OpenStreetMap (OSM) and Ordnance Survey. We will use some OSM data from the Ilse of Wight, which can be loaded as follows:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">u</span> <span class="op">=</span> <span class="st">"https://github.com/ropensci/stats19/releases/download/1.1.0/roads_key.Rds"</span></span>
<span><span class="va">roads_wgs</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/connections.html" class="external-link">url</a></span><span class="op">(</span><span class="va">u</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">roads</span> <span class="op">=</span> <span class="va">roads_wgs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span>crs <span class="op">=</span> <span class="fl">27700</span><span class="op">)</span></span></code></pre></div>
<p>You should already have road crashes for the Isle of Wight from the previous stage. If not, load crash data as follows:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">u</span> <span class="op">=</span> <span class="st">"https://github.com/ropensci/stats19/releases/download/1.1.0/car_collisions_2022_iow.Rds"</span></span>
<span><span class="va">crashes_iow</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/connections.html" class="external-link">url</a></span><span class="op">(</span><span class="va">u</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Plot the roads with the crashes overlaid.</li>
<li>Create a buffer around the roads with a distance of 200 m.</li>
<li>How many crashes fall outside the buffered roads?</li>
<li>Bonus: Use the <code><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate()</a></code> function to identify how many crashes happened per segment and plot the result (hint: see <code><a href="https://r-spatial.github.io/sf/reference/aggregate.sf.html" class="external-link">?aggregate.sf</a></code> and take a read of Section <a href="https://r.geocompx.org/spatial-operations.html" class="external-link">4.2.5</a> of Geocomputation with R) with <code>tmap</code> and plot the crashes that happened outside the road buffers on top.</li>
</ol>
<div style="page-break-after: always;"></div>
</div>
<div class="section level2">
<h2 id="bonus-exercises">Bonus exercises<a class="anchor" aria-label="anchor" href="#bonus-exercises"></a>
</h2>
<p>Identify a region and zonal units of interest from <a href="https://geoportal.statistics.gov.uk/" class="external-link uri">https://geoportal.statistics.gov.uk/</a> or from the object <code>police_boundaries</code> in the <code>stats19</code> package.</p>
<ol style="list-style-type: decimal">
<li>Read them into R as an <code>sf</code> object</li>
<li>Create a map showing the number of crashes in each zone</li>
<li>Identify the average speed limit associated with crashes in each zone</li>
<li>Identify an interesting question you can ask to the data and use exploratory data analysis to find answers</li>
<li>Check another <a href="https://github.com/agila5/leeds_seminar" class="external-link">related project</a> for further information on smoothing techniques of counts on a linear network. <!-- 1. Take a look at the code in [the file iow_example.R in the inst directory in the stats19 repo](https://github.com/ropensci/stats19/blob/master/inst/iow_example.R). Run it to create smoothed estimates of crash frequency on the road network (see [code in the  GitHub repo](https://github.com/agila5/leeds_seminar/blob/master/examples.R) for further information on these preliminary methods). -->
</li>
</ol>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-lovelace_reproducible_2020" class="csl-entry">
Lovelace, Robin. 2020. <span>“Reproducible Road Safety Research with <span>R</span>.”</span> <span>Royal Automotive Club Foundation</span>.
</div>
<div id="ref-lovelace_stats19_2019" class="csl-entry">
Lovelace, Robin, Malcolm Morgan, Layik Hama, Mark Padgham, and M Padgham. 2019. <span>“Stats19 <span>A</span> Package for Working with Open Road Crash Data.”</span> <em>Journal of Open Source Software</em> 4 (33): 1181. <a href="https://doi.org/10.21105/joss.01181" class="external-link">https://doi.org/10.21105/joss.01181</a>.
</div>
<div id="ref-lovelace_geocomputation_2019" class="csl-entry">
Lovelace, Robin, Jakub Nowosad, and Jannes Muenchow. 2019. <em>Geocomputation with <span>R</span></em>. <span>CRC Press</span>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>

  

  

  </body>
</html>
